<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rosuc</title>
    <link rel="icon" type="image/png" href="icon.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <!-- Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
</head>

<body>
    <div class="app-container">
        <!-- Left Sidebar (File Explorer) -->
        <aside class="sidebar-left" id="sidebar-left">
            <div class="sidebar-header">
                <div style="display: flex; align-items: center; gap: 8px;">
                    <img src="icon.png" alt="Rosuc Logo" style="width: 20px; height: 20px;">
                    <h2>BDA Group 20</h2>
                </div>
                <div style="display:flex; align-items:center; gap:6px;">
                    <button id="new-file-btn" class="icon-btn" title="New File"><i data-lucide="file-plus"></i></button>
                    <button id="toggle-left-sidebar" class="icon-btn" title="Collapse Sidebar"><i data-lucide="panel-left-close"></i></button>
                </div>
            </div>
            <div class="file-list" id="file-list">
                <!-- File items will go here -->
            </div>
        </aside>
        <div class="sidebar-resizer" id="left-resizer" aria-label="Resize left sidebar"></div>

        <!-- Main Content (Editor) -->
        <main class="main-content">
            <header class="editor-toolbar">
                <div class="toolbar-group">
                    <button class="format-btn" data-command="bold" title="Bold (Cmd+B)"><i
                            data-lucide="bold"></i></button>
                    <button class="format-btn" data-command="italic" title="Italic (Cmd+I)"><i
                            data-lucide="italic"></i></button>
                    <button class="format-btn" data-command="underline" title="Underline (Cmd+U)"><i
                            data-lucide="underline"></i></button>
                </div>
                <div class="toolbar-divider"></div>
                <div class="toolbar-group">
                    <div class="custom-select" id="font-select-container">
                        <div class="select-trigger" id="font-trigger">
                            <span id="font-value">Times New Roman</span>
                            <i data-lucide="chevron-down" style="width: 12px;"></i>
                        </div>
                        <div class="select-options hidden" id="font-options">
                            <div class="select-option" data-value="Inter">Inter</div>
                            <div class="select-option" data-value="Arial">Arial</div>
                            <div class="select-option" data-value="Helvetica">Helvetica</div>
                            <div class="select-option" data-value="Verdana">Verdana</div>
                            <div class="select-option" data-value="Tahoma">Tahoma</div>
                            <div class="select-option" data-value="Trebuchet MS">Trebuchet MS</div>
                            <div class="select-option selected" data-value="Times New Roman">Times New Roman</div>
                            <div class="select-option" data-value="Georgia">Georgia</div>
                            <div class="select-option" data-value="Garamond">Garamond</div>
                            <div class="select-option" data-value="Courier New">Courier New</div>
                            <div class="select-option" data-value="JetBrains Mono">JetBrains Mono</div>
                        </div>
                    </div>
                </div>
                <div class="toolbar-divider"></div>
                <div class="toolbar-group">
                    <button class="format-btn" data-command="formatBlock" data-value="H1" title="Heading 1"><i
                            data-lucide="heading-1"></i></button>
                    <button class="format-btn" data-command="formatBlock" data-value="H2" title="Heading 2"><i
                            data-lucide="heading-2"></i></button>
                    <button class="format-btn" data-command="formatBlock" data-value="P" title="Paragraph"><i
                            data-lucide="pilcrow"></i></button>
                    <button class="format-btn" data-command="insertOrderedList" title="Numbered List"><i
                            data-lucide="list-ordered"></i></button>
                </div>
                <div class="toolbar-divider"></div>
                <div class="toolbar-group">
                    <button class="format-btn" id="undo-btn" title="Undo (Cmd+Z)"><i data-lucide="undo"></i></button>
                    <button class="format-btn" id="redo-btn" title="Redo (Cmd+Shift+Z)"><i
                            data-lucide="redo"></i></button>
                </div>
                <div class="toolbar-divider"></div>
                <div class="toolbar-group">
                    <button class="format-btn" id="insert-image-btn" title="Insert Image"><i
                            data-lucide="image"></i></button>
                    <input type="file" id="image-upload" accept="image/*" class="hidden">
                </div>
                <div class="toolbar-divider"></div>
                <div class="toolbar-group">
                    <button class="format-btn" id="search-btn" title="Find"><i data-lucide="search"></i></button>
                    <button class="format-btn" id="print-btn" title="Print"><i data-lucide="printer"></i></button>
                </div>
                <div class="spacer"></div>
            </header>

            <div class="editor-container">
                <div id="editor" class="editor" contenteditable="true" spellcheck="false">
                    <h1>Untitled Draft</h1>
                    <p>Start writing here...</p>
                </div>
            </div>
        </main>

        <!-- Right Sidebar (Chat/AI) -->
        <div class="sidebar-resizer" id="right-resizer" aria-label="Resize right sidebar"></div>
        <aside class="sidebar" id="sidebar-right">
            <div class="sidebar-header">
                <div class="mode-toggle">
                    <button id="mode-chat" class="mode-btn active">Chat</button>
                    <button id="mode-editor" class="mode-btn">Editor</button>
                </div>
                <button id="new-chat-btn" class="icon-btn" title="New Session"><i
                        data-lucide="plus-circle"></i></button>
                <button id="settings-btn" class="icon-btn" title="Settings"><i data-lucide="settings"></i></button>
                <button id="toggle-right-sidebar" class="icon-btn" title="Collapse Sidebar"><i data-lucide="panel-right-close"></i></button>
            </div>
            <div class="chat-history" id="chat-history">
                <div class="chat-message ai">
                    <div class="message-content">Hello! Please add your <strong>Gemini API Key</strong> in settings to
                        get started.<br><br>You can use <strong>Cmd+K</strong> to edit text, or ask me questions here.
                    </div>
                </div>
            </div>
            <div class="chat-input-area">
                <textarea id="chat-input" placeholder="Ask a question..." rows="1"></textarea>
                <button id="send-chat-btn" class="icon-btn primary"><i data-lucide="send"></i></button>
            </div>
            <div class="sidebar-footer">
                <div class="custom-select" id="model-select-container">
                    <div class="select-trigger" id="model-trigger">
                        <span id="model-value">Gemini 2.5 Flash Lite</span>
                        <i data-lucide="chevron-down" style="width: 12px;"></i>
                    </div>
                    <div class="select-options hidden" id="model-options">
                        <div class="select-option selected" data-value="gemini-2.5-flash-lite">Gemini 2.5 Flash Lite
                        </div>
                        <div class="select-option" data-value="gemini-2.5-flash">Gemini 2.5 Flash</div>
                        <div class="select-option" data-value="gemini-2.5-pro">Gemini 2.5 Pro</div>
                        <div class="select-option" data-value="gemini-3.0-pro-preview">Gemini 3.0 Pro</div>
                    </div>
                </div>
            </div>
        </aside>
    </div>

    <!-- Diff Controls (Hidden by default, cloned when needed) -->
    <div id="diff-controls-template" class="diff-controls hidden">
        <button class="diff-btn accept" title="Accept Change"><i data-lucide="check"></i></button>
        <button class="diff-btn reject" title="Reject Change"><i data-lucide="x"></i></button>
    </div>

    <!-- Custom Search Bar -->
    <div id="search-bar" class="search-bar hidden">
        <input type="text" id="search-input" placeholder="Find...">
        <div class="search-actions">
            <button id="search-prev-btn" class="search-btn" title="Previous"><i data-lucide="chevron-up"></i></button>
            <button id="search-next-btn" class="search-btn" title="Next"><i data-lucide="chevron-down"></i></button>
            <div class="search-divider"></div>
            <button id="search-close-btn" class="search-btn" title="Close"><i data-lucide="x"></i></button>
        </div>
    </div>

    <!-- New File / Rename Modal -->
    <div id="file-modal" class="modal hidden">
        <div class="modal-content settings-box">
            <h3 id="file-modal-title">New File</h3>
            <div class="form-group">
                <label for="file-name-input">Name</label>
                <input type="text" id="file-name-input" placeholder="Enter file name...">
            </div>
            <div class="modal-actions">
                <button id="cancel-file-btn" class="btn secondary">Cancel</button>
                <button id="confirm-file-btn" class="btn primary">Create</button>
            </div>
        </div>
    </div>

    <!-- Inline Edit Modal (Cmd+K) -->
    <div id="inline-edit-modal" class="modal hidden">
        <div class="modal-content inline-edit-box">

            <div class="inline-input-wrapper">
                <input type="text" id="inline-input" placeholder="Edit selection... (e.g., 'Make it shorter')">
                <div class="inline-actions">
                    <span class="keyboard-hint">Esc to cancel</span>
                    <button id="close-inline-btn" class="icon-btn small" title="Close"><i data-lucide="x"></i></button>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settings-modal" class="modal hidden">
        <div class="modal-content settings-box">
            <h3>Settings</h3>
            <div class="form-group">
                <label for="api-key-input">Gemini API Keys (One per line)</label>
                <textarea id="api-key-input" placeholder="Paste your API keys here..." rows="4"
                    style="width: 100%; resize: vertical; font-family: monospace; background:#0f172a; color:#e2e8f0; border:1px solid #1f2937; border-radius:10px; padding:12px; box-shadow:0 8px 24px rgba(0,0,0,0.18);"></textarea>
                <p class="help-text">Keys are stored locally. If one fails, the next will be used.</p>
            </div>
            <div class="modal-actions">
                <button id="save-settings-btn" class="btn primary">Save</button>
                <button id="close-settings-btn" class="btn secondary">Cancel</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        lucide.createIcons();
        document.querySelectorAll('svg').forEach(svg => svg.removeAttribute('xmlns'));
    </script>
</body>

</html>